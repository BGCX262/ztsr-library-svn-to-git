package library.client;

import java.rmi.RemoteException;
import library.common.LibraryException;
import javax.swing.JOptionPane;

/**
 * @author  Karolina
 */
public class MenuPanel extends javax.swing.JPanel {
    
    private LoginPanel loginPanel;
    private FindPanel findPanel;
    private StatePanel statePanel;
    private SessionData sData;
    
    /** Creates new form MainPanel */
    public MenuPanel(SessionData sd) {
        initComponents();
        this.setVisible(false);
        sData = sd;
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        internalPanel = new javax.swing.JPanel();
        stateButton = new javax.swing.JButton();
        findButton = new javax.swing.JButton();
        logOutButton = new javax.swing.JButton();

        stateButton.setFont(new java.awt.Font("Tahoma", 1, 12));
        stateButton.setText("Stan konta");
        stateButton.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                stateButtonKeyPressed(evt);
            }
        });
        stateButton.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                stateButtonMouseClicked(evt);
            }
        });

        findButton.setFont(new java.awt.Font("Tahoma", 1, 12));
        findButton.setText("Wyszukaj");
        findButton.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                findButtonKeyPressed(evt);
            }
        });
        findButton.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                findButtonMouseClicked(evt);
            }
        });

        logOutButton.setFont(new java.awt.Font("Tahoma", 1, 12));
        logOutButton.setText("Wyloguj");
        logOutButton.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                logOutButtonKeyPressed(evt);
            }
        });
        logOutButton.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                logOutButtonMouseClicked(evt);
            }
        });

        org.jdesktop.layout.GroupLayout internalPanelLayout = new org.jdesktop.layout.GroupLayout(internalPanel);
        internalPanel.setLayout(internalPanelLayout);
        internalPanelLayout.setHorizontalGroup(
            internalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(org.jdesktop.layout.GroupLayout.TRAILING, internalPanelLayout.createSequentialGroup()
                .add(49, 49, 49)
                .add(internalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                    .add(org.jdesktop.layout.GroupLayout.LEADING, logOutButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 169, Short.MAX_VALUE)
                    .add(stateButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 169, Short.MAX_VALUE)
                    .add(findButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 169, Short.MAX_VALUE))
                .add(40, 40, 40))
        );
        internalPanelLayout.setVerticalGroup(
            internalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(internalPanelLayout.createSequentialGroup()
                .add(22, 22, 22)
                .add(stateButton)
                .add(35, 35, 35)
                .add(findButton)
                .add(35, 35, 35)
                .add(logOutButton)
                .addContainerGap(31, Short.MAX_VALUE))
        );

        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .add(214, 214, 214)
                .add(internalPanel, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(221, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .add(156, 156, 156)
                .add(internalPanel, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(156, Short.MAX_VALUE))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void logOutButtonKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_logOutButtonKeyPressed
        if (evt.getKeyCode() == evt.VK_ENTER){
            this.logOutButtonAccept();
        }
    }//GEN-LAST:event_logOutButtonKeyPressed

    private void findButtonKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_findButtonKeyPressed
        if (evt.getKeyCode() == evt.VK_ENTER){
            this.findButtonAccept();
        }
    }//GEN-LAST:event_findButtonKeyPressed

    private void stateButtonAccept(){
        if (!sData.isAnonymous()){
            this.setVisible(false);
            statePanel.activatePanel();
        }
    }
    private void stateButtonKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_stateButtonKeyPressed
        if (evt.getKeyCode() == evt.VK_ENTER){
            this.stateButtonAccept();
        }
    }//GEN-LAST:event_stateButtonKeyPressed

    private void findButtonAccept(){
        this.setVisible(false);
        findPanel.setVisible(true);
    }
    
    private void findButtonMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_findButtonMouseClicked
        this.findButtonAccept();
    }//GEN-LAST:event_findButtonMouseClicked

    private void stateButtonMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_stateButtonMouseClicked
        this.stateButtonAccept();
    }//GEN-LAST:event_stateButtonMouseClicked

    private void logOutButtonAccept(){
        try{
            sData.logOut();
            this.setVisible(false);
            loginPanel.setVisible(true);
        }catch(RemoteException e){
            JOptionPane.showMessageDialog(this, e.detail.getLocalizedMessage(),"Uwaga",JOptionPane.WARNING_MESSAGE);
        }        
    }
    private void logOutButtonMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_logOutButtonMouseClicked
        this.logOutButtonAccept();
    }//GEN-LAST:event_logOutButtonMouseClicked
    
    public void setParentPanel(LoginPanel l) { loginPanel = l; }
    
    public void setStatePanel(StatePanel s) { statePanel = s; }
    
    public void setFindPanel(FindPanel f) { findPanel = f;}
    
    public void activatePanel(){
        this.stateButton.setEnabled(!sData.isAnonymous());
        this.setVisible(true);
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton findButton;
    private javax.swing.JPanel internalPanel;
    private javax.swing.JButton logOutButton;
    private javax.swing.JButton stateButton;
    // End of variables declaration//GEN-END:variables
    
}
